{
  "name": "Naybourhood.ai Platform",
  "description": "Complete backend schema for property lead generation platform with admin client management",
  "version": "2.0.0",
  "tables": [
    {
      "name": "Users",
      "description": "Platform users (developers, agents, brokers, admins)",
      "fields": [
        { "name": "email", "type": "email", "required": true, "unique": true },
        { "name": "full_name", "type": "singleLineText", "required": true },
        { "name": "phone", "type": "phoneNumber" },
        { "name": "avatar_url", "type": "url" },
        { "name": "user_type", "type": "singleSelect", "options": ["developer", "agent", "broker", "admin"] },
        { "name": "status", "type": "singleSelect", "options": ["active", "inactive", "pending", "suspended"] },
        { "name": "company", "type": "link", "linkedTable": "Companies" },
        { "name": "onboarded_by", "type": "link", "linkedTable": "Users", "description": "Admin who onboarded this user" },
        { "name": "onboarded_at", "type": "dateTime" },
        { "name": "last_login", "type": "dateTime" },
        { "name": "login_count", "type": "number", "precision": 0 },
        { "name": "created_at", "type": "createdTime" }
      ]
    },
    {
      "name": "Companies",
      "description": "Client companies",
      "fields": [
        { "name": "name", "type": "singleLineText", "required": true },
        { "name": "website", "type": "url" },
        { "name": "industry", "type": "singleSelect", "options": ["residential", "commercial", "mixed", "lettings", "financial"] },
        { "name": "address", "type": "multilineText" },
        { "name": "logo_url", "type": "url" },
        { "name": "primary_contact", "type": "link", "linkedTable": "Users" },
        { "name": "users", "type": "link", "linkedTable": "Users", "multiple": true },
        { "name": "campaigns", "type": "link", "linkedTable": "Campaigns", "multiple": true },
        { "name": "subscription", "type": "link", "linkedTable": "Subscriptions" },
        { "name": "monthly_budget", "type": "currency", "symbol": "£" },
        { "name": "total_spend", "type": "rollup", "linkedTable": "Invoices", "field": "amount", "aggregation": "sum" },
        { "name": "total_leads", "type": "rollup", "linkedTable": "Leads", "aggregation": "count" },
        { "name": "status", "type": "singleSelect", "options": ["active", "inactive", "trial", "churned"] },
        { "name": "onboarded_by", "type": "link", "linkedTable": "Users", "description": "Admin who onboarded this company" },
        { "name": "onboarded_at", "type": "dateTime" },
        { "name": "notes", "type": "multilineText" },
        { "name": "created_at", "type": "createdTime" }
      ]
    },
    {
      "name": "User_Roles",
      "description": "Role-based access control",
      "fields": [
        { "name": "user", "type": "link", "linkedTable": "Users", "required": true },
        { "name": "role", "type": "singleSelect", "options": ["super_admin", "admin", "manager", "member", "viewer"], "required": true },
        { "name": "granted_by", "type": "link", "linkedTable": "Users" },
        { "name": "granted_at", "type": "dateTime" }
      ]
    },
    {
      "name": "Client_Invitations",
      "description": "Pending client onboarding invitations",
      "fields": [
        { "name": "email", "type": "email", "required": true },
        { "name": "name", "type": "singleLineText", "required": true },
        { "name": "phone", "type": "phoneNumber" },
        { "name": "company_name", "type": "singleLineText", "required": true },
        { "name": "client_type", "type": "singleSelect", "options": ["developer", "agent", "broker"], "required": true },
        { "name": "status", "type": "singleSelect", "options": ["pending", "sent", "opened", "accepted", "expired", "cancelled"], "required": true },
        { "name": "invitation_token", "type": "singleLineText", "description": "Unique token for invitation link" },
        { "name": "assigned_campaigns", "type": "link", "linkedTable": "Campaigns", "multiple": true },
        { "name": "monthly_budget", "type": "currency", "symbol": "£" },
        { "name": "notes", "type": "multilineText" },
        { "name": "invited_by", "type": "link", "linkedTable": "Users", "required": true },
        { "name": "sent_at", "type": "dateTime" },
        { "name": "opened_at", "type": "dateTime" },
        { "name": "accepted_at", "type": "dateTime" },
        { "name": "expires_at", "type": "dateTime" },
        { "name": "created_company", "type": "link", "linkedTable": "Companies", "description": "Company created upon acceptance" },
        { "name": "created_user", "type": "link", "linkedTable": "Users", "description": "User created upon acceptance" },
        { "name": "created_at", "type": "createdTime" }
      ]
    },
    {
      "name": "Onboarding_Steps",
      "description": "Track client onboarding progress",
      "fields": [
        { "name": "company", "type": "link", "linkedTable": "Companies", "required": true },
        { "name": "user", "type": "link", "linkedTable": "Users", "required": true },
        { "name": "step", "type": "singleSelect", "options": ["invitation_sent", "account_created", "profile_completed", "integrations_connected", "first_campaign_created", "first_lead_received"], "required": true },
        { "name": "completed", "type": "checkbox" },
        { "name": "completed_at", "type": "dateTime" },
        { "name": "notes", "type": "singleLineText" }
      ]
    },
    {
      "name": "Developments",
      "description": "Property developments",
      "fields": [
        { "name": "name", "type": "singleLineText", "required": true },
        { "name": "company", "type": "link", "linkedTable": "Companies", "required": true },
        { "name": "location", "type": "singleLineText" },
        { "name": "country", "type": "singleSelect", "options": ["United Kingdom", "UAE", "Saudi Arabia", "Qatar", "Kuwait", "Bahrain", "Oman", "Jordan", "Turkey", "Egypt", "Nigeria", "Ghana", "Kenya", "South Africa"] },
        { "name": "city", "type": "singleLineText" },
        { "name": "total_units", "type": "number", "precision": 0 },
        { "name": "available_units", "type": "number", "precision": 0 },
        { "name": "price_from", "type": "currency", "symbol": "£" },
        { "name": "price_to", "type": "currency", "symbol": "£" },
        { "name": "bedrooms_range", "type": "singleLineText" },
        { "name": "status", "type": "singleSelect", "options": ["pre-launch", "live", "sold-out"] },
        { "name": "description", "type": "multilineText" },
        { "name": "image_url", "type": "url" },
        { "name": "features", "type": "multipleSelects", "options": ["gym", "pool", "concierge", "parking", "garden", "balcony", "security", "spa"] },
        { "name": "completion_date", "type": "date" },
        { "name": "created_at", "type": "createdTime" }
      ]
    },
    {
      "name": "Campaigns",
      "description": "Meta advertising campaigns",
      "fields": [
        { "name": "name", "type": "singleLineText", "required": true },
        { "name": "company", "type": "link", "linkedTable": "Companies", "required": true },
        { "name": "development", "type": "link", "linkedTable": "Developments" },
        { "name": "user_type", "type": "singleSelect", "options": ["developer", "agent", "broker"] },
        { "name": "objective", "type": "singleSelect", "options": ["leads", "awareness"] },
        { "name": "status", "type": "singleSelect", "options": ["draft", "pending", "active", "paused", "completed"] },
        { "name": "managed_by", "type": "singleSelect", "options": ["client", "naybourhood"], "description": "Who manages this campaign" },
        { "name": "audience_maturity", "type": "singleSelect", "options": ["cold-start", "warm-data", "verified-lookalikes"] },
        { "name": "audience_clusters", "type": "multipleSelects", "options": ["Young Professionals", "HNWI", "First-Time Buyers", "Investors", "Downsizers", "Families", "Expats", "Holiday Home Seekers"] },
        { "name": "anti_tire_kicker_enabled", "type": "checkbox" },
        { "name": "target_countries", "type": "multipleSelects", "options": ["United Kingdom", "UAE", "Saudi Arabia", "Qatar", "Kuwait", "Bahrain", "Oman", "Jordan", "Turkey", "Egypt", "Nigeria", "Ghana", "Kenya", "South Africa"] },
        { "name": "target_cities", "type": "multipleSelects", "options": ["London", "Manchester", "Birmingham", "Dubai", "Abu Dhabi", "Riyadh", "Jeddah", "Doha", "Kuwait City", "Lagos", "Accra", "Nairobi", "Cairo"] },
        { "name": "target_regions", "type": "multipleSelects", "options": ["uk", "middle-east", "africa"] },
        { "name": "total_budget", "type": "currency", "symbol": "£" },
        { "name": "daily_cap", "type": "currency", "symbol": "£" },
        { "name": "start_date", "type": "date" },
        { "name": "end_date", "type": "date" },
        { "name": "whatsapp_addon", "type": "checkbox" },
        { "name": "landing_page_url", "type": "url" },
        { "name": "cta_type", "type": "singleSelect", "options": ["learn-more", "book-viewing", "submit-offer", "request-callback", "book-consultation", "download-brochure"] },
        { "name": "pixel_id", "type": "singleLineText" },
        { "name": "conversion_events", "type": "multipleSelects", "options": ["Lead", "ViewContent", "SubmitForm", "Schedule", "Contact"] },
        { "name": "utm_campaign", "type": "singleLineText" },
        { "name": "utm_source", "type": "singleLineText" },
        { "name": "utm_medium", "type": "singleLineText" },
        { "name": "meta_campaign_id", "type": "singleLineText" },
        { "name": "meta_adset_id", "type": "singleLineText" },
        { "name": "meta_ad_ids", "type": "multilineText" },
        { "name": "meta_form_id", "type": "singleLineText" },
        { "name": "total_leads", "type": "rollup", "linkedTable": "Leads", "aggregation": "count" },
        { "name": "total_spend", "type": "rollup", "linkedTable": "Campaign_Metrics", "field": "spend", "aggregation": "sum" },
        { "name": "creative_assets", "type": "link", "linkedTable": "Creative_Assets", "multiple": true },
        { "name": "ad_copies", "type": "link", "linkedTable": "Ad_Copies", "multiple": true },
        { "name": "leads", "type": "link", "linkedTable": "Leads", "multiple": true },
        { "name": "created_by", "type": "link", "linkedTable": "Users" },
        { "name": "created_at", "type": "createdTime" }
      ]
    },
    {
      "name": "Creative_Assets",
      "description": "Campaign creative files",
      "fields": [
        { "name": "campaign", "type": "link", "linkedTable": "Campaigns", "required": true },
        { "name": "type", "type": "singleSelect", "options": ["static", "carousel", "video", "ugc"] },
        { "name": "file", "type": "attachment" },
        { "name": "thumbnail_url", "type": "url" },
        { "name": "file_size_bytes", "type": "number" },
        { "name": "status", "type": "singleSelect", "options": ["pending", "approved", "rejected"] },
        { "name": "performance_score", "type": "number", "precision": 0 },
        { "name": "created_at", "type": "createdTime" }
      ]
    },
    {
      "name": "Ad_Copies",
      "description": "Campaign ad copy variations",
      "fields": [
        { "name": "campaign", "type": "link", "linkedTable": "Campaigns", "required": true },
        { "name": "headline", "type": "singleLineText" },
        { "name": "body", "type": "multilineText" },
        { "name": "cta", "type": "singleSelect", "options": ["Learn More", "Book Viewing", "Get Quote", "Contact Us", "Download Brochure"] },
        { "name": "message_angle", "type": "singleSelect", "options": ["investment", "family", "holiday-home", "downsizer", "first-time-buyer"] },
        { "name": "is_ai_generated", "type": "checkbox" },
        { "name": "performance_score", "type": "number", "precision": 0 },
        { "name": "created_at", "type": "createdTime" }
      ]
    },
    {
      "name": "Campaign_Metrics",
      "description": "Daily campaign performance data",
      "fields": [
        { "name": "campaign", "type": "link", "linkedTable": "Campaigns", "required": true },
        { "name": "date", "type": "date", "required": true },
        { "name": "platform", "type": "singleSelect", "options": ["facebook", "instagram", "messenger", "audience_network"] },
        { "name": "impressions", "type": "number", "precision": 0 },
        { "name": "clicks", "type": "number", "precision": 0 },
        { "name": "spend", "type": "currency", "symbol": "£" },
        { "name": "leads", "type": "number", "precision": 0 },
        { "name": "ctr", "type": "percent", "precision": 2 },
        { "name": "cpc", "type": "currency", "symbol": "£" },
        { "name": "cpl", "type": "currency", "symbol": "£" },
        { "name": "cpm", "type": "currency", "symbol": "£" },
        { "name": "reach", "type": "number", "precision": 0 },
        { "name": "frequency", "type": "number", "precision": 2 },
        { "name": "mobile_leads", "type": "number", "precision": 0 },
        { "name": "desktop_leads", "type": "number", "precision": 0 },
        { "name": "verified_leads", "type": "number", "precision": 0 },
        { "name": "high_intent_leads", "type": "number", "precision": 0 }
      ]
    },
    {
      "name": "Leads",
      "description": "All captured leads with dual scoring",
      "fields": [
        { "name": "campaign", "type": "link", "linkedTable": "Campaigns" },
        { "name": "company", "type": "link", "linkedTable": "Companies", "required": true },
        { "name": "development", "type": "link", "linkedTable": "Developments" },
        { "name": "full_name", "type": "singleLineText", "required": true },
        { "name": "email", "type": "email", "required": true },
        { "name": "phone", "type": "phoneNumber" },
        { "name": "country", "type": "singleSelect", "options": ["United Kingdom", "UAE", "Saudi Arabia", "Qatar", "Kuwait", "Bahrain", "Oman", "Jordan", "Turkey", "Egypt", "Nigeria", "Ghana", "Kenya", "South Africa"] },
        { "name": "city", "type": "singleLineText" },
        { "name": "budget_min", "type": "currency", "symbol": "£" },
        { "name": "budget_max", "type": "currency", "symbol": "£" },
        { "name": "bedrooms", "type": "singleSelect", "options": ["1", "2", "3", "4+"] },
        { "name": "timeline", "type": "singleSelect", "options": ["Within 28 days", "0-3 months", "3-6 months", "6-9 months", "9-12 months", "12+ months"] },
        { "name": "payment_method", "type": "singleSelect", "options": ["cash", "mortgage", "investor"] },
        { "name": "property_purpose", "type": "singleSelect", "options": ["residence", "investment", "holiday"] },
        { "name": "property_value", "type": "currency", "symbol": "£", "description": "Mortgage broker field" },
        { "name": "borrowing_amount", "type": "currency", "symbol": "£", "description": "Mortgage broker field" },
        { "name": "browsing_status", "type": "singleSelect", "options": ["browsing", "active-looking"], "description": "Mortgage broker field" },
        { "name": "quality_score", "type": "number", "precision": 0, "description": "0-100" },
        { "name": "intent_score", "type": "number", "precision": 0, "description": "0-100" },
        { "name": "classification", "type": "singleSelect", "options": ["hot", "quality", "intent", "valid", "cold", "at-risk", "disqualified"] },
        { "name": "sla_deadline", "type": "dateTime", "description": "When this lead must be contacted by" },
        { "name": "sla_status", "type": "singleSelect", "options": ["on-track", "due-soon", "overdue"] },
        { "name": "lead_source", "type": "singleSelect", "options": ["meta", "google", "rightmove", "zoopla", "onthemarket", "website", "email", "introducer", "crm", "csv"] },
        { "name": "source_detail", "type": "singleLineText" },
        { "name": "utm_campaign", "type": "singleLineText" },
        { "name": "utm_content", "type": "singleLineText" },
        { "name": "utm_term", "type": "singleLineText" },
        { "name": "device_type", "type": "singleSelect", "options": ["mobile", "desktop", "tablet"] },
        { "name": "status", "type": "singleSelect", "options": ["new", "contacted", "qualified", "viewing-booked", "offer-made", "won", "lost"] },
        { "name": "assigned_agent", "type": "link", "linkedTable": "Users" },
        { "name": "notes", "type": "multilineText" },
        { "name": "verification_mortgage_aip", "type": "checkbox" },
        { "name": "verification_lawyer", "type": "checkbox" },
        { "name": "verification_uk_resident", "type": "checkbox" },
        { "name": "verification_kyc_aml", "type": "checkbox" },
        { "name": "verification_proof_of_funds", "type": "checkbox" },
        { "name": "interactions", "type": "link", "linkedTable": "Lead_Interactions", "multiple": true },
        { "name": "behavioral_analytics", "type": "link", "linkedTable": "Lead_Behavioral_Analytics" },
        { "name": "created_at", "type": "createdTime" }
      ]
    },
    {
      "name": "Lead_Interactions",
      "description": "Lead engagement timeline",
      "fields": [
        { "name": "lead", "type": "link", "linkedTable": "Leads", "required": true },
        { "name": "type", "type": "singleSelect", "options": ["form-submit", "email-open", "email-click", "whatsapp-reply", "call", "viewing", "brochure-download", "offer-submitted", "note-added"] },
        { "name": "description", "type": "singleLineText" },
        { "name": "performed_by", "type": "link", "linkedTable": "Users" },
        { "name": "metadata", "type": "multilineText", "description": "JSON data" },
        { "name": "created_at", "type": "createdTime" }
      ]
    },
    {
      "name": "Lead_Behavioral_Analytics",
      "description": "Tracked behavioral data for leads",
      "fields": [
        { "name": "lead", "type": "link", "linkedTable": "Leads", "required": true },
        { "name": "brochure_views", "type": "number", "precision": 0 },
        { "name": "whatsapp_clicks", "type": "number", "precision": 0 },
        { "name": "email_opens", "type": "number", "precision": 0 },
        { "name": "time_on_site_seconds", "type": "number", "precision": 0 },
        { "name": "page_views", "type": "number", "precision": 0 },
        { "name": "last_activity", "type": "dateTime" },
        { "name": "engagement_score", "type": "number", "precision": 0, "description": "Calculated total engagement" },
        { "name": "auto_analysis_triggered", "type": "checkbox" },
        { "name": "auto_analysis_at", "type": "dateTime" }
      ]
    },
    {
      "name": "Lead_Sources",
      "description": "Configured lead ingestion sources",
      "fields": [
        { "name": "company", "type": "link", "linkedTable": "Companies", "required": true },
        { "name": "source_type", "type": "singleSelect", "options": ["portal", "website", "email", "introducer", "crm"] },
        { "name": "name", "type": "singleLineText" },
        { "name": "config", "type": "multilineText", "description": "JSON config" },
        { "name": "webhook_url", "type": "url" },
        { "name": "is_active", "type": "checkbox" },
        { "name": "leads_count", "type": "rollup", "linkedTable": "Leads", "aggregation": "count" },
        { "name": "created_at", "type": "createdTime" }
      ]
    },
    {
      "name": "Automation_Sequences",
      "description": "WhatsApp/Email drip campaigns",
      "fields": [
        { "name": "company", "type": "link", "linkedTable": "Companies", "required": true },
        { "name": "name", "type": "singleLineText", "required": true },
        { "name": "channel", "type": "singleSelect", "options": ["whatsapp", "email", "sms"] },
        { "name": "trigger", "type": "singleSelect", "options": ["new-lead", "viewing-booked", "offer-made", "manual", "classification-change"] },
        { "name": "target_classifications", "type": "multipleSelects", "options": ["hot", "quality", "intent", "valid", "cold"] },
        { "name": "is_active", "type": "checkbox" },
        { "name": "messages", "type": "link", "linkedTable": "Automation_Messages", "multiple": true },
        { "name": "created_at", "type": "createdTime" }
      ]
    },
    {
      "name": "Automation_Messages",
      "description": "Individual messages in sequences",
      "fields": [
        { "name": "sequence", "type": "link", "linkedTable": "Automation_Sequences", "required": true },
        { "name": "order", "type": "number", "precision": 0 },
        { "name": "delay_days", "type": "number", "precision": 0 },
        { "name": "delay_hours", "type": "number", "precision": 0 },
        { "name": "subject", "type": "singleLineText", "description": "Email only" },
        { "name": "body", "type": "multilineText" },
        { "name": "cta_text", "type": "singleLineText" },
        { "name": "cta_url", "type": "url" },
        { "name": "is_ai_generated", "type": "checkbox" }
      ]
    },
    {
      "name": "Subscriptions",
      "description": "Client billing and plans",
      "fields": [
        { "name": "company", "type": "link", "linkedTable": "Companies", "required": true },
        { "name": "plan", "type": "singleSelect", "options": ["starter", "growth", "enterprise", "custom"] },
        { "name": "status", "type": "singleSelect", "options": ["active", "past-due", "cancelled", "trial", "paused"] },
        { "name": "monthly_fee", "type": "currency", "symbol": "£" },
        { "name": "setup_fee", "type": "currency", "symbol": "£" },
        { "name": "leads_included", "type": "number", "precision": 0 },
        { "name": "leads_used", "type": "number", "precision": 0 },
        { "name": "overage_rate", "type": "currency", "symbol": "£", "description": "Per lead over included" },
        { "name": "billing_cycle", "type": "singleSelect", "options": ["monthly", "quarterly", "annual"] },
        { "name": "billing_cycle_start", "type": "date" },
        { "name": "billing_cycle_end", "type": "date" },
        { "name": "trial_ends_at", "type": "date" },
        { "name": "stripe_subscription_id", "type": "singleLineText" },
        { "name": "stripe_customer_id", "type": "singleLineText" },
        { "name": "auto_renew", "type": "checkbox" },
        { "name": "created_at", "type": "createdTime" }
      ]
    },
    {
      "name": "Invoices",
      "description": "Payment records",
      "fields": [
        { "name": "company", "type": "link", "linkedTable": "Companies", "required": true },
        { "name": "subscription", "type": "link", "linkedTable": "Subscriptions" },
        { "name": "invoice_number", "type": "singleLineText", "required": true },
        { "name": "amount", "type": "currency", "symbol": "£" },
        { "name": "tax_amount", "type": "currency", "symbol": "£" },
        { "name": "total_amount", "type": "currency", "symbol": "£" },
        { "name": "status", "type": "singleSelect", "options": ["draft", "pending", "paid", "failed", "refunded", "cancelled"] },
        { "name": "invoice_date", "type": "date" },
        { "name": "due_date", "type": "date" },
        { "name": "paid_at", "type": "date" },
        { "name": "payment_method", "type": "singleSelect", "options": ["card", "bank_transfer", "direct_debit"] },
        { "name": "stripe_invoice_id", "type": "singleLineText" },
        { "name": "stripe_payment_intent_id", "type": "singleLineText" },
        { "name": "pdf_url", "type": "url" },
        { "name": "line_items", "type": "link", "linkedTable": "Invoice_Line_Items", "multiple": true }
      ]
    },
    {
      "name": "Invoice_Line_Items",
      "description": "Individual items on invoices",
      "fields": [
        { "name": "invoice", "type": "link", "linkedTable": "Invoices", "required": true },
        { "name": "description", "type": "singleLineText", "required": true },
        { "name": "quantity", "type": "number", "precision": 0 },
        { "name": "unit_price", "type": "currency", "symbol": "£" },
        { "name": "total", "type": "currency", "symbol": "£" },
        { "name": "type", "type": "singleSelect", "options": ["subscription", "setup", "overage", "ad_spend", "service", "discount"] }
      ]
    },
    {
      "name": "Payment_Methods",
      "description": "Stored payment methods for companies",
      "fields": [
        { "name": "company", "type": "link", "linkedTable": "Companies", "required": true },
        { "name": "type", "type": "singleSelect", "options": ["card", "bank_account", "direct_debit"] },
        { "name": "last_four", "type": "singleLineText" },
        { "name": "brand", "type": "singleSelect", "options": ["visa", "mastercard", "amex"] },
        { "name": "expiry_month", "type": "number", "precision": 0 },
        { "name": "expiry_year", "type": "number", "precision": 0 },
        { "name": "is_default", "type": "checkbox" },
        { "name": "stripe_payment_method_id", "type": "singleLineText" },
        { "name": "created_at", "type": "createdTime" }
      ]
    },
    {
      "name": "Settings",
      "description": "Platform and integration settings",
      "fields": [
        { "name": "company", "type": "link", "linkedTable": "Companies", "required": true },
        { "name": "meta_app_id", "type": "singleLineText" },
        { "name": "meta_access_token", "type": "singleLineText" },
        { "name": "meta_ad_account_id", "type": "singleLineText" },
        { "name": "meta_pixel_id", "type": "singleLineText" },
        { "name": "whatsapp_phone_id", "type": "singleLineText" },
        { "name": "whatsapp_access_token", "type": "singleLineText" },
        { "name": "whatsapp_business_id", "type": "singleLineText" },
        { "name": "whatsapp_webhook_verify_token", "type": "singleLineText" },
        { "name": "n8n_webhook_url", "type": "url" },
        { "name": "n8n_api_key", "type": "singleLineText" },
        { "name": "timezone", "type": "singleSelect", "options": ["Europe/London", "Asia/Dubai", "Africa/Lagos", "Africa/Cairo"] },
        { "name": "date_format", "type": "singleSelect", "options": ["DD/MM/YYYY", "MM/DD/YYYY", "YYYY-MM-DD"] },
        { "name": "email_notifications", "type": "checkbox" },
        { "name": "push_notifications", "type": "checkbox" },
        { "name": "weekly_report", "type": "checkbox" },
        { "name": "sla_hot_lead_hours", "type": "number", "precision": 0, "description": "Default: 1" },
        { "name": "sla_quality_lead_hours", "type": "number", "precision": 0, "description": "Default: 4" },
        { "name": "sla_warm_lead_hours", "type": "number", "precision": 0, "description": "Default: 24" }
      ]
    },
    {
      "name": "Audit_Logs",
      "description": "Activity tracking",
      "fields": [
        { "name": "user", "type": "link", "linkedTable": "Users" },
        { "name": "company", "type": "link", "linkedTable": "Companies" },
        { "name": "action", "type": "singleSelect", "options": ["create", "update", "delete", "login", "logout", "export", "import", "invite_sent", "invite_accepted", "status_change", "payment"] },
        { "name": "entity_type", "type": "singleLineText" },
        { "name": "entity_id", "type": "singleLineText" },
        { "name": "old_value", "type": "multilineText", "description": "JSON" },
        { "name": "new_value", "type": "multilineText", "description": "JSON" },
        { "name": "ip_address", "type": "singleLineText" },
        { "name": "user_agent", "type": "singleLineText" },
        { "name": "created_at", "type": "createdTime" }
      ]
    },
    {
      "name": "AI_Analysis_Results",
      "description": "Stored AI analysis for leads and campaigns",
      "fields": [
        { "name": "lead", "type": "link", "linkedTable": "Leads" },
        { "name": "campaign", "type": "link", "linkedTable": "Campaigns" },
        { "name": "company", "type": "link", "linkedTable": "Companies" },
        { "name": "analysis_type", "type": "singleSelect", "options": ["lead_scoring", "campaign_optimization", "budget_recommendation", "creative_suggestion"] },
        { "name": "model_used", "type": "singleLineText" },
        { "name": "input_data", "type": "multilineText", "description": "JSON" },
        { "name": "result", "type": "multilineText", "description": "JSON" },
        { "name": "recommendations", "type": "multilineText" },
        { "name": "applied", "type": "checkbox" },
        { "name": "applied_at", "type": "dateTime" },
        { "name": "applied_by", "type": "link", "linkedTable": "Users" },
        { "name": "created_at", "type": "createdTime" }
      ]
    },
    {
      "name": "Webhook_Events",
      "description": "Incoming webhook events log",
      "fields": [
        { "name": "company", "type": "link", "linkedTable": "Companies" },
        { "name": "source", "type": "singleSelect", "options": ["meta", "stripe", "whatsapp", "pixel", "email", "crm"] },
        { "name": "event_type", "type": "singleLineText" },
        { "name": "payload", "type": "multilineText", "description": "JSON" },
        { "name": "status", "type": "singleSelect", "options": ["received", "processed", "failed", "ignored"] },
        { "name": "error_message", "type": "singleLineText" },
        { "name": "processed_at", "type": "dateTime" },
        { "name": "created_at", "type": "createdTime" }
      ]
    }
  ],
  "relationships": {
    "Users → Companies": "Many-to-One (via company field)",
    "Companies → Users": "One-to-Many (via users field)",
    "Client_Invitations → Users": "Many-to-One (invited_by, created_user)",
    "Client_Invitations → Companies": "Many-to-One (created_company)",
    "Client_Invitations → Campaigns": "Many-to-Many (assigned_campaigns)",
    "Onboarding_Steps → Companies": "Many-to-One",
    "Onboarding_Steps → Users": "Many-to-One",
    "Campaigns → Companies": "Many-to-One",
    "Campaigns → Developments": "Many-to-One",
    "Leads → Campaigns": "Many-to-One",
    "Leads → Companies": "Many-to-One",
    "Subscriptions → Companies": "One-to-One",
    "Invoices → Companies": "Many-to-One",
    "Invoices → Subscriptions": "Many-to-One",
    "Invoice_Line_Items → Invoices": "Many-to-One",
    "Payment_Methods → Companies": "Many-to-One",
    "AI_Analysis_Results → Leads/Campaigns": "Many-to-One"
  },
  "indexes": [
    "Users.email (unique)",
    "Companies.name",
    "Client_Invitations.email",
    "Client_Invitations.invitation_token (unique)",
    "Leads.email",
    "Leads.classification",
    "Leads.sla_status",
    "Campaigns.status",
    "Invoices.invoice_number (unique)",
    "Invoices.status"
  ],
  "automations": [
    {
      "name": "Set SLA deadline on lead creation",
      "trigger": "Lead created",
      "action": "Calculate sla_deadline based on classification"
    },
    {
      "name": "Update SLA status",
      "trigger": "Every 15 minutes",
      "action": "Check leads approaching/past deadline, update sla_status"
    },
    {
      "name": "Process invitation acceptance",
      "trigger": "Client_Invitation.status changed to 'accepted'",
      "action": "Create Company and User records, link to invitation"
    },
    {
      "name": "Send weekly reports",
      "trigger": "Every Monday 9am",
      "action": "Generate and email weekly performance reports to companies with weekly_report enabled"
    },
    {
      "name": "Invoice reminder",
      "trigger": "3 days before due_date",
      "action": "Send payment reminder email"
    }
  ]
}
